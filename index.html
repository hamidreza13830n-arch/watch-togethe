<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
<title>Watch Together</title>

<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>

<style>
*{box-sizing:border-box;margin:0;padding:0}
html,body{height:100%}

body{
font-family:Arial;
color:white;
display:flex;
flex-direction:column;
min-height:100dvh;
overflow:hidden;
background:linear-gradient(-45deg,#1f1c2c,#928dab,#0f2027,#2c5364);
background-size:400% 400%;
animation:bg 12s ease infinite;
}
@keyframes bg{
0%{background-position:0% 50%}
50%{background-position:100% 50%}
100%{background-position:0% 50%}
}

body.dark{background:#0b0b12}

.glass{
background:rgba(255,255,255,.08);
backdrop-filter:blur(12px);
border:1px solid rgba(255,255,255,.1);
border-radius:18px;
}

header{
height:42px;
flex-shrink:0;
display:flex;
justify-content:space-between;
align-items:center;
padding:0 12px;
}

.main{
flex:1;
display:flex;
flex-direction:column;
padding:8px;
gap:8px;
overflow:hidden;
}

.video-container{
flex:0 0 40%;
padding:10px;
display:flex;
flex-direction:column;
}
video{
width:100%;
flex:1;
border-radius:12px;
}

.chat-container{
flex:1;
padding:10px;
display:flex;
flex-direction:column;
min-height:0;
}

.chat-box{
flex:1;
overflow-y:auto;
display:flex;
flex-direction:column;
gap:6px;
}

.message{
padding:8px 10px;
border-radius:14px;
max-width:75%;
font-size:14px;
display:flex;
flex-direction:column;
gap:4px;
position:relative;
}

.me{align-self:flex-end;background:#0088ff;border-bottom-right-radius:4px}
.other{align-self:flex-start;background:#2a2a32;border-bottom-left-radius:4px}

.meta{
font-size:10px;
opacity:.7;
display:flex;
justify-content:flex-end;
gap:4px;
}

.reply-box{
font-size:11px;
opacity:.8;
border-left:3px solid #fff;
padding-left:6px;
margin-bottom:4px;
}

.reactions{
display:flex;
gap:4px;
font-size:14px;
margin-top:4px;
}

.reaction-picker{
position:absolute;
bottom:100%;
background:#1c1c22;
padding:6px;
border-radius:10px;
display:flex;
gap:6px;
font-size:18px;
}

.input-area{
display:flex;
gap:6px;
margin-top:6px;
flex-shrink:0;
}
.input-area input{
flex:1;
padding:10px;
border-radius:12px;
border:none;
font-size:16px;
}
.input-area button{
padding:10px 12px;
border:none;
border-radius:12px;
background:#e50914;
color:white;
}

/* SETTINGS */
#settings{
position:fixed;
right:-260px;
top:0;
width:240px;
height:100%;
padding:20px;
transition:.3s;
z-index:100;
}
#settings.open{right:0}
#settings button{
width:100%;
margin-bottom:10px;
padding:8px;
border:none;
border-radius:10px;
background:#e50914;
color:white;
}

/* LOGIN */
#login{
position:fixed;
inset:0;
background:#000000dd;
display:flex;
justify-content:center;
align-items:center;
flex-direction:column;
z-index:999;
}
.login-box{
padding:30px;
text-align:center;
}
.login-box input{
padding:10px;
border-radius:12px;
border:none;
margin-bottom:10px;
}

/* WELCOME */
#welcomeOverlay{
position:fixed;
inset:0;
background:rgba(0,0,0,.6);
display:none;
justify-content:center;
align-items:center;
z-index:998;
}
.welcome-box{
padding:30px;
text-align:center;
width:280px;
}
.welcome-box button{
padding:10px 20px;
border:none;
border-radius:12px;
background:#e50914;
color:white;
}

@media (orientation:landscape){
.main{flex-direction:row}
.video-container{flex:0 0 60%}
}
</style>
</head>

<body>

<div id="login">
<div class="login-box glass">
<h3>Ø±Ù…Ø² Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯</h3>
<input id="pass">
<button onclick="checkPass()">ØªØ§ÛŒÛŒØ¯</button>
</div>
</div>

<div id="welcomeOverlay">
<div class="welcome-box glass">
<h3>Ø³Ù„Ø§Ù… Ø¹Ø²ÛŒØ²Ù… â¤ï¸ Ø®ÙˆØ´ Ø¢Ù…Ø¯ÛŒ</h3>
<button onclick="closeWelcome()">ÙˆØ±ÙˆØ¯</button>
</div>
</div>

<header>
<span>ğŸ¬ Watch Together</span>
<div>
<span id="online">Online: 1</span>
<button onclick="toggleSettings()">âš™ï¸</button>
</div>
</header>

<div id="settings" class="glass">

<h3 style="margin-bottom:10px">Ù¾Ø®Ø´ ÙÛŒÙ„Ù…</h3>

<input id="videoLinkInput" placeholder="Ù„ÛŒÙ†Ú© ÙÛŒÙ„Ù…..."
style="width:100%;padding:8px;border-radius:10px;border:none;margin-bottom:8px">

<button onclick="setVideoLink()">Ù¾Ø®Ø´ ÙÛŒÙ„Ù…</button>

<hr style="margin:15px 0;opacity:.3">

<button onclick="toggleDark()">Ø¯Ø§Ø±Ú© Ù…ÙˆØ¯</button>
<button onclick="clearChat()">Ø­Ø°Ù ØªØ§Ø±ÛŒØ®Ú†Ù‡</button>
<button onclick="toggleSettings()">Ø¨Ø³ØªÙ†</button>
</div>

<div class="main">

<div class="video-container glass">
<video id="video" controls></video>
</div>

<div class="chat-container glass">
<div class="chat-box" id="chat"></div>
<div class="input-area">
<input id="msg" placeholder="Ù¾ÛŒØ§Ù…...">
<button onclick="send()">Send</button>
</div>
</div>

</div>

<script>
var firebaseConfig={
apiKey:"AIzaSyCDHmmKIYPHDyvx4BXTb-7VP6lmVb8BCYw",
authDomain:"film-online-922c1.firebaseapp.com",
databaseURL:"https://film-online-922c1-default-rtdb.firebaseio.com/",
projectId:"film-online-922c1"
};
firebase.initializeApp(firebaseConfig);
var db=firebase.database();

var username="user"+Math.floor(Math.random()*1000);
var myId=Math.random().toString(36).substr(2,9);
var replyTo=null;

/* LOGIN */
function checkPass(){
if(pass.value==="bazsho20"){
login.style.display="none";
welcomeOverlay.style.display="flex";
}
}
function closeWelcome(){welcomeOverlay.style.display="none"}

/* SETTINGS */
function toggleSettings(){settings.classList.toggle("open")}
function toggleDark(){document.body.classList.toggle("dark")}

/* VIDEO LINK */
function setVideoLink(){
var link=document.getElementById("videoLinkInput").value;
if(!link)return;
db.ref("video/url").set(link);
videoLinkInput.value="";
toggleSettings();
}

db.ref("video/url").on("value",snap=>{
if(snap.val())video.src=snap.val();
});

/* ONLINE */
db.ref("online/"+myId).set(true);
db.ref("online/"+myId).onDisconnect().remove();
db.ref("online").on("value",snap=>{
online.innerText="Online: "+snap.numChildren();
});

/* CHAT */
function send(){
if(!msg.value)return;
db.ref("chat").push({
text:msg.value,
user:username,
time:Date.now(),
reply:replyTo,
seen:false,
reactions:{}
});
msg.value="";
replyTo=null;
}

db.ref("chat").on("child_added",snap=>{
var d=snap.val();
var key=snap.key;

if(d.user!==username){
db.ref("chat/"+key+"/seen").set(true);
}

var div=document.createElement("div");
div.className="message "+(d.user===username?"me":"other");
div.id="m_"+key;

if(d.reply){
var rep=document.createElement("div");
rep.className="reply-box";
rep.innerText=d.reply;
div.appendChild(rep);
}

var text=document.createElement("div");
text.innerText=d.text;
div.appendChild(text);

var meta=document.createElement("div");
meta.className="meta";
meta.innerHTML=new Date(d.time).toLocaleTimeString().slice(0,5)
+(d.user===username?" <span id='s"+key+"'>âœ”</span>":"");
div.appendChild(meta);

var react=document.createElement("div");
react.className="reactions";
div.appendChild(react);

div.onclick=function(e){
e.stopPropagation();
showReactions(key,div);
replyTo=d.text;
};

chat.appendChild(div);
chat.scrollTop=chat.scrollHeight;

if(d.user===username){
db.ref("chat/"+key+"/seen").on("value",s=>{
document.getElementById("s"+key).innerText=s.val()?"âœ”âœ”":"âœ”";
});
}
});

/* REACTIONS */
function showReactions(key,div){
if(div.querySelector(".reaction-picker"))return;
var picker=document.createElement("div");
picker.className="reaction-picker";
["ğŸ˜","ğŸ¤£","â¤ï¸","ğŸ‘Œ","ğŸ©·","ğŸ”¥","ğŸ˜­","ğŸ˜","ğŸ˜œ","ğŸ˜±","ğŸ’”"].forEach(e=>{
var span=document.createElement("span");
span.innerText=e;
span.onclick=function(ev){
ev.stopPropagation();
db.ref("chat/"+key+"/reactions/"+myId).set(e);
picker.remove();
};
picker.appendChild(span);
});
div.appendChild(picker);
}

db.ref("chat").on("child_changed",snap=>{
var d=snap.val();
var react=document.querySelector("#m_"+snap.key+" .reactions");
react.innerHTML="";
if(d.reactions){
Object.values(d.reactions).forEach(e=>{
react.innerHTML+=e+" ";
});
}
});

/* CLEAR */
function clearChat(){
db.ref("chat").remove();
chat.innerHTML="";
}
</script>

</body>
</html>
