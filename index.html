<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Watch Together</title>

<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>

<style>
:root{
  --card-dark: rgba(20,20,24,.85);
  --card-light: rgba(255,255,255,.15);
  --blur: blur(18px);
  --border: rgba(255,255,255,.15);
}

body{
  margin:0;
  font-family:Arial;
  color:white;
  height:100vh;
  display:flex;
  flex-direction:column;
  overflow:hidden;
  background:#0b0b12;
  position:relative;
  transition:.4s;
}

/* ÿ®⁄©‚Äå⁄Øÿ±ÿßŸÜÿØ ŸÖÿ™ÿ≠ÿ±⁄© */
body::before{
  content:"";
  position:fixed;
  inset:-50%;
  background:
    radial-gradient(circle at 20% 30%, rgba(229,9,20,.4), transparent 40%),
    radial-gradient(circle at 80% 20%, rgba(0,136,204,.35), transparent 40%),
    radial-gradient(circle at 60% 80%, rgba(168,85,247,.3), transparent 40%);
  animation: moveLights 18s infinite alternate ease-in-out;
  filter: blur(120px);
  z-index:-1;
}

@keyframes moveLights{
  0%{ transform: translate(-10%, -10%) scale(1); }
  100%{ transform: translate(10%, 10%) scale(1.1); }
}

/* ===== Header Compact ===== */
header{
  height:42px;
  padding:0 12px;
  display:flex;
  justify-content:space-between;
  align-items:center;
  font-weight:600;
  font-size:14px;
  background:linear-gradient(90deg, rgba(15,15,20,.9), rgba(25,25,30,.9));
  backdrop-filter:blur(10px);
  border-bottom:1px solid rgba(255,255,255,.05);
}

header span:first-child{
  font-size:15px;
  font-weight:700;
  letter-spacing:.5px;
}

#onlineCount{
  font-size:12px;
  opacity:.85;
  margin-right:6px;
}

.settings-btn{
  font-size:16px;
  cursor:pointer;
  transition:.2s;
}
.settings-btn:active{
  transform:scale(.9);
}

/* Overlay */
.overlay{
  position:fixed;
  inset:0;
  background:rgba(0,0,0,.5);
  backdrop-filter:blur(5px);
  opacity:0;
  pointer-events:none;
  transition:.3s;
  z-index:90;
}
.overlay.active{
  opacity:1;
  pointer-events:auto;
}

/* Settings Panel */
.settings-panel{
  position:fixed;
  top:0;
  right:-320px;
  width:280px;
  height:100%;
  padding:25px 20px;
  transition:.4s;
  z-index:100;
  color:white;
  background:
    radial-gradient(circle at 30% 20%, rgba(229,9,20,.35), transparent 40%),
    radial-gradient(circle at 80% 30%, rgba(0,136,204,.3), transparent 40%),
    radial-gradient(circle at 50% 90%, rgba(168,85,247,.25), transparent 40%),
    rgba(20,20,24,.9);
  backdrop-filter:blur(25px);
  border-left:1px solid rgba(255,255,255,.1);
  box-shadow:-10px 0 40px rgba(0,0,0,.6);
}
.settings-panel.open{ right:0; }

.settings-header{
  display:flex;
  justify-content:space-between;
  align-items:center;
  margin-bottom:20px;
}

.close-btn{
  cursor:pointer;
  font-size:22px;
}

.settings-item{
  margin-bottom:20px;
  padding:10px;
  border-radius:12px;
  background:rgba(255,255,255,.05);
  backdrop-filter:blur(10px);
}

.toggle{
  display:flex;
  justify-content:space-between;
  align-items:center;
}

.main{
  flex:1;
  display:flex;
  flex-direction:column;
  gap:10px;
  padding:10px;
}

.video-container,
.chat-container{
  border-radius:16px;
  padding:12px;
  display:flex;
  flex-direction:column;
  gap:8px;
  transition:.4s;
}

.video-container{flex:1.6;}
.chat-container{flex:1;}

.dark .video-container,
.dark .chat-container{
  background:var(--card-dark);
}

.light .video-container,
.light .chat-container{
  background:var(--card-light);
  backdrop-filter:var(--blur);
  border:1px solid var(--border);
}

.link-bar{display:flex;gap:8px;}
.link-bar input{flex:1;padding:10px;border-radius:18px;border:none;}
.link-bar button{padding:10px 14px;border:none;border-radius:18px;background:#e50914;color:white;font-weight:bold;}

video{width:100%;height:100%;border-radius:14px;background:black;}

.speed-control{display:flex;justify-content:flex-end;}

.chat-box{
  flex:1;
  overflow-y:auto;
  display:flex;
  flex-direction:column;
  gap:8px;
}

.message{
  max-width:80%;
  padding:10px 14px;
  border-radius:15px;
  font-size:14px;
}

.my-message{align-self:flex-end;background:#0088cc;}
.other-message{align-self:flex-start;background:#262626;}

.input-area{
  display:flex;
  gap:8px;
  margin-top:8px;
}
.input-area input{
  flex:1;
  padding:10px;
  border-radius:20px;
  border:none;
}
.input-area button{
  padding:10px 16px;
  border:none;
  border-radius:20px;
  background:#e50914;
  color:white;
  font-weight:bold;
}

@media (orientation: landscape){
  .main{flex-direction:row;}
  .video-container{flex:1.7;}
  .chat-container{flex:1;}
}
</style>
</head>

<body class="dark">

<div class="overlay" id="overlay" onclick="closeSettings()"></div>

<header>
<span>üé¨ Watch Together</span>
<span>
<span id="onlineCount">Online: 1</span>
<span class="settings-btn" onclick="openSettings()">‚öôÔ∏è</span>
</span>
</header>

<div class="settings-panel" id="settingsPanel">
<div class="settings-header">
<h3>Settings</h3>
<span class="close-btn" onclick="closeSettings()">√ó</span>
</div>

<div class="settings-item">
<div class="toggle">
<label>Dark Mode</label>
<input type="checkbox" id="themeToggle" checked onchange="toggleTheme()">
</div>
</div>

</div>

<div class="main">

<div class="video-container">
<div class="link-bar">
<input id="movieLink" placeholder="Paste mp4 link...">
<button onclick="loadVideo()">Load</button>
</div>

<video id="video" controls></video>

<div class="speed-control">
<select onchange="video.playbackRate=this.value">
<option value="0.5">0.5x</option>
<option value="1" selected>1x</option>
<option value="1.5">1.5x</option>
<option value="2">2x</option>
</select>
</div>
</div>

<div class="chat-container">
<div class="chat-box" id="chat"></div>
<div class="input-area">
<input id="message" placeholder="Message">
<button onclick="sendMessage()">Send</button>
</div>
</div>

</div>

<script>
function openSettings(){
document.getElementById("settingsPanel").classList.add("open");
document.getElementById("overlay").classList.add("active");
}
function closeSettings(){
document.getElementById("settingsPanel").classList.remove("open");
document.getElementById("overlay").classList.remove("active");
}
function toggleTheme(){
if(document.getElementById("themeToggle").checked){
document.body.classList.remove("light");
document.body.classList.add("dark");
}else{
document.body.classList.remove("dark");
document.body.classList.add("light");
}
}

var firebaseConfig={
apiKey:"AIzaSyCDHmmKIYPHDyvx4BXTb-7VP6lmVb8BCYw",
authDomain:"film-online-922c1.firebaseapp.com",
databaseURL:"https://film-online-922c1-default-rtdb.firebaseio.com/",
projectId:"film-online-922c1"
};
firebase.initializeApp(firebaseConfig);
var db=firebase.database();

var userId=Math.random().toString(36).substr(2,9);
var userRef=db.ref("onlineUsers/"+userId);
userRef.set(true);
userRef.onDisconnect().remove();

db.ref("onlineUsers").on("value",snap=>{
document.getElementById("onlineCount").innerText="Online: "+snap.numChildren();
});

db.ref("chat").remove();

function loadVideo(){
db.ref("video/link").set(document.getElementById("movieLink").value);
}
db.ref("video/link").on("value",snap=>{
if(snap.val()) video.src=snap.val();
});

function sendMessage(){
var msg=document.getElementById("message").value;
if(!msg)return;
db.ref("chat").push({text:msg,time:new Date().toLocaleTimeString()});
document.getElementById("message").value="";
}

db.ref("chat").on("child_added",snap=>{
var data=snap.val();
var div=document.createElement("div");
div.className="message";
div.innerHTML=`<div>${data.text}</div>`;
document.getElementById("chat").appendChild(div);
});
</script>

</body>
</html>
