<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Watch Together</title>

<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>

<style>
:root{
  --card-dark: rgba(20,20,24,.85);
  --card-light: rgba(255,255,255,.15);
  --blur: blur(18px);
  --border: rgba(255,255,255,.15);
}

body{
  margin:0;
  font-family:Arial;
  color:white;
  height:100vh;
  display:flex;
  flex-direction:column;
  overflow:hidden;
  background:#0b0b12;
  position:relative;
  transition:0.4s;
}

/* Ù¾Ø³â€ŒØ²Ù…ÛŒÙ†Ù‡ Ù†ÙˆØ± */
body::before{
  content:"";
  position:fixed;
  inset:-50%;
  background:
    radial-gradient(circle at 20% 30%, rgba(229,9,20,.4), transparent 40%),
    radial-gradient(circle at 80% 20%, rgba(0,136,204,.35), transparent 40%),
    radial-gradient(circle at 60% 80%, rgba(168,85,247,.3), transparent 40%);
  animation: moveLights 18s infinite alternate ease-in-out;
  filter: blur(120px);
  z-index:-1;
}

@keyframes moveLights{
  0%{ transform: translate(-10%, -10%) scale(1); }
  100%{ transform: translate(10%, 10%) scale(1.1); }
}

header{
  padding:12px;
  display:flex;
  justify-content:space-between;
  align-items:center;
  font-weight:bold;
}

.settings-btn{
  cursor:pointer;
  font-size:20px;
}

/* Ù¾Ù†Ù„ ØªÙ†Ø¸ÛŒÙ…Ø§Øª */
.settings-panel{
  position:fixed;
  top:0;
  right:-300px;
  width:260px;
  height:100%;
  background:rgba(20,20,24,.95);
  backdrop-filter:blur(20px);
  padding:20px;
  transition:0.4s;
  z-index:100;
}

.settings-panel.open{ right:0; }

.settings-panel h3{margin-top:0;}

.settings-item{
  margin-bottom:15px;
}

.toggle{
  display:flex;
  align-items:center;
  gap:10px;
}

.main{flex:1;display:flex;flex-direction:column;gap:10px;padding:10px;}

.video-container,
.chat-container{
  flex:1;
  border-radius:16px;
  padding:12px;
  display:flex;
  flex-direction:column;
  gap:8px;
  transition:0.4s;
}

/* Ø­Ø§Ù„Øª ØªØ§Ø±ÛŒÚ© */
.dark .video-container,
.dark .chat-container{
  background:var(--card-dark);
}

/* Ø­Ø§Ù„Øª Ø±ÙˆØ´Ù† Ø´ÛŒØ´Ù‡â€ŒØ§ÛŒ */
.light .video-container,
.light .chat-container{
  background:var(--card-light);
  backdrop-filter:var(--blur);
  border:1px solid var(--border);
}

.video-container{flex:1.6;}

.link-bar{display:flex;gap:8px;}
.link-bar input{flex:1;padding:10px;border-radius:18px;border:none;}
.link-bar button{padding:10px 14px;border:none;border-radius:18px;background:#e50914;color:white;font-weight:bold;}

video{width:100%;height:100%;border-radius:14px;background:black;}

.speed-control{display:flex;justify-content:flex-end;}

.chat-box{flex:1;overflow-y:auto;display:flex;flex-direction:column;gap:8px;}

.message{
  max-width:80%;
  padding:10px 14px;
  border-radius:15px;
  font-size:14px;
  position:relative;
}

.my-message{align-self:flex-end;background:#0088cc;}
.other-message{align-self:flex-start;background:#262626;}

.light .other-message{background:rgba(255,255,255,.25);}
.light .my-message{background:rgba(0,136,204,.6);}

.meta{font-size:11px;opacity:.7;margin-top:4px;}

.reply-preview{
  background:rgba(255,255,255,.2);
  padding:5px;
  border-left:3px solid #e50914;
  border-radius:6px;
  font-size:12px;
}

.input-area{display:flex;gap:8px;margin-top:8px;}
.input-area input{flex:1;padding:10px;border-radius:20px;border:none;}
.input-area button{padding:10px 16px;border:none;border-radius:20px;background:#e50914;color:white;font-weight:bold;}

@media (orientation: landscape){
  .main{flex-direction:row;}
  .video-container{flex:1.7;}
  .chat-container{flex:1;}
}
</style>
</head>

<body class="dark">

<header>
<span>ğŸ¬ Watch Together</span>
<span>
<span id="onlineCount">Online: 1</span>
<span class="settings-btn" onclick="toggleSettings()">âš™ï¸</span>
</span>
</header>

<div class="settings-panel" id="settingsPanel">
<h3>Settings</h3>

<div class="settings-item">
<div class="toggle">
<label>Dark Mode</label>
<input type="checkbox" id="themeToggle" checked onchange="toggleTheme()">
</div>
</div>

<!-- Ø¢ÛŒÙ†Ø¯Ù‡ Ø§ÛŒÙ†Ø¬Ø§ ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ø§Ø¶Ø§ÙÙ‡ Ù…ÛŒâ€ŒÚ©Ù†ÛŒÙ… -->

</div>

<div class="main">

<div class="video-container">
<div class="link-bar">
<input id="movieLink" placeholder="Paste mp4 link...">
<button onclick="loadVideo()">Load</button>
</div>

<video id="video" controls></video>

<div class="speed-control">
<select onchange="video.playbackRate=this.value">
<option value="0.5">0.5x</option>
<option value="1" selected>1x</option>
<option value="1.5">1.5x</option>
<option value="2">2x</option>
</select>
</div>
</div>

<div class="chat-container">
<div class="chat-box" id="chat"></div>
<div id="replyBox"></div>
<div class="input-area">
<input id="message" placeholder="Message">
<button onclick="sendMessage()">Send</button>
</div>
</div>

</div>

<script>
function toggleSettings(){
document.getElementById("settingsPanel").classList.toggle("open");
}

function toggleTheme(){
if(document.getElementById("themeToggle").checked){
document.body.classList.remove("light");
document.body.classList.add("dark");
}else{
document.body.classList.remove("dark");
document.body.classList.add("light");
}
}

/* Firebase Ù‚Ø¨Ù„ÛŒ */
var firebaseConfig={
apiKey:"AIzaSyCDHmmKIYPHDyvx4BXTb-7VP6lmVb8BCYw",
authDomain:"film-online-922c1.firebaseapp.com",
databaseURL:"https://film-online-922c1-default-rtdb.firebaseio.com/",
projectId:"film-online-922c1"
};
firebase.initializeApp(firebaseConfig);
var db=firebase.database();
var video=document.getElementById("video");

if(!localStorage.getItem("username")){
localStorage.setItem("username",prompt("Your name?")||"Guest");
}
var currentUser=localStorage.getItem("username");

var userId=Math.random().toString(36).substr(2,9);
var userRef=db.ref("onlineUsers/"+userId);
userRef.set(true);
userRef.onDisconnect().remove();

db.ref("onlineUsers").on("value",snap=>{
document.getElementById("onlineCount").innerText="Online: "+snap.numChildren();
});

db.ref("chat").remove();

function loadVideo(){
db.ref("video/link").set(document.getElementById("movieLink").value);
}
db.ref("video/link").on("value",snap=>{
if(snap.val()) video.src=snap.val();
});

function sendMessage(){
var msg=document.getElementById("message").value;
if(!msg)return;

var now=new Date();
var time=now.getHours().toString().padStart(2,'0')+":"+
now.getMinutes().toString().padStart(2,'0');

db.ref("chat").push({user:currentUser,text:msg,time:time});
document.getElementById("message").value="";
}

db.ref("chat").on("child_added",snap=>{
var data=snap.val();
var div=document.createElement("div");
div.className="message "+(data.user===currentUser?"my-message":"other-message");
div.innerHTML=`<div>${data.text}</div><div class="meta">${data.time}</div>`;
document.getElementById("chat").appendChild(div);
});
</script>

</body>
</html>
